# homework 1

В этой ветке содержится решение 1-ой домашней работы по курсу "Глубокие генеративные модели".
Все использованные библиотеки указаны в `requirements.txt`

Author: Фёдорова Инесса Алексеевна

## MLE + Bayes для стилей и изображений

Файл task1.ipynb содержит исходный код решения этой части ДЗ с комментариями. Для генерации всех возможных стилей и подсчета их вероятности использована рекуррентная функция generate_bayes_dist. Для выбора случайного стиля с учетом вероятностей используется функция `np.random.choice`. Пример стиля и его вероятности - `['прическа: длинные прямые; цвет волос: серебристо серый; аксесуар: круглые очки; одежда: футболка с круглым вырезом; цвет одежды: серый']',
[0.0036462514632565656]`.

Для генерации аватаров использованы изображения из основного репозитория курса. После подсчета вероятностей для каждого пикселя каждого канала происходит генерация 5 новых аватаров, примеры которых в папке `avatars`. Из-за высокого разрешения исходных изображений, получаемые отличаются лишь в отдельных пикселях, что почти незаметно для человеческого глаза.

<img src="avatars/0.png" height=400 align = "center"/>


## Автоэнкодер для детекции аномалий

Файл task2.ipynb содержит исходный код решения этой части ДЗ. 

Задача заключается в детекции аномалий на изображениях лунок, в которые заливается металл для отливки изделий. В качестве базовой архитектуры была выбрана модель SegNet (CNN), видоизмененная под данную задачу (подобрано оптимальное сочетание слоев для получения разделимых векторных представлений), которая обучалась с MSE со следующими параметрами:
- epoch = 2
- lr = 0.001
- batch_size = 128
- img_size = (32, 32)

График лосса 

<img src="static/loss.png" height=400 align = "center"/>

Модель достаточно сходится за первые две эпохи, дальнейшее обучение незначительно ухудшает векторные представления и метрики, сравнение метрик по эпохам приведено в таблице

| Epoch |    #1    |    #2    | #5  |
|:-----:|:--------:|:--------:|-----|
|  TP   |   0.78   |   0.85   |  0.82   |
|  TN   |   0.76   |  0.83    |  0.81   |

Визуализация векторного пространства модели с помощью umap

<img src="static/umap.jpg" height=400 align = "center"/>

TruePositiveRate и TrueNegativeRate от threshold (MSE между входной и картинкой из модели для по сета из папки proliv)

<img src="static/tptr.png" height=400 align = "center"/>

Оптимальный трешхолд, в первую очередь, зависит от бизнес-постановки (что для нас важнее - покрыть все, либо же минимизировать ложные срабатывания), в данном случае, следуя стратегии автоматического подбора оптимального трешхолда, я бы выбрала точку в которой линии пересекаются и равны примерно 0.8 `(TP: 0.85, TN: 0.83)`. 
